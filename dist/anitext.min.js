(function(root,factory){if(typeof define==="function"&&define.amd){define([],function(){return factory(root)})}else if(typeof exports==="object"){module.exports=factory(root)}else{root.anitext=factory(root)}})(typeof global!=="undefined"?global:typeof window!=="undefined"?window:this,function(window){"use strict";var anitext={};var options;var defaults={selector:".anitext-container",minTimeToRead:1e3,direction:"bottom",animDuration:300,readDelay:0,animDelay:0,animateBy:"sentence"};var destroySentence=event=>{if(event.target.classList.contains("active")||event.target.classList.contains("active")&&event.target.nextSibling===null){event.target.parentElement.removeChild(event.target)}else if(event.target.matches("div")){event.target.classList.add("active")}else{event.target.parentElement.classList.add("active")}};var initCustomFn=(fn,el)=>{if(!el.classList.contains("active")){var tmpFunc=new Function(fn);tmpFunc()}};var timeToRead=string=>{let ttr=String(string).split(" ").length*300;ttr=ttr>options.minTimeToRead?ttr:options.minTimeToRead;return ttr};var fDirection=index=>{var fDirection;if(options.sentences[index+1]&&options.sentences[index+1].iDirection){fDirection=options.sentences[index+1].iDirection}else{fDirection=options.direction}return fDirection};var splitChars=sentence=>{return sentence.replace(/[a-zA-ZÀ-ÿ\d\u00f1\u00d1\!¡@#$´%^¨&*()_+\-=\[\]{}~;':"\\|,.<>\/?]|\s/g,"<span>$&</span>")};var splitWords=sentence=>{return sentence.replace(/[a-zA-ZÀ-ÿ\d\u00f1\u00d1\!¡@#$´%^¨&*()_+\-=\[\]{}~;':"\\|,.<>\/?]+|\s/g,"<span>$&</span>")};var setDefaults=sentence=>{if(!sentence.iDirection){sentence.iDirection=options.direction}else if(!/bottom|top|right|left/.test(sentence.iDirection)){console.warn(`anitext: using default iDirection. (invalid value: ${sentence.direction})`);sentence.iDirection=options.direction}if(!sentence.timeToRead){sentence.timeToRead=timeToRead(sentence.text)}else if(!(sentence.timeToRead>=0)){console.warn(`anitext: using default timeToRead. (invalid value: ${sentence.timeToRead})`);sentence.timeToRead=timeToRead(sentence.text)}if(!sentence.animateBy){sentence.animateBy=options.animateBy}else if(!/sentence|words|chars/.test(sentence.animateBy)){console.warn(`anitext: using default animateBy. (invalid value: ${sentence.animateBy})`);sentence.animateBy=options.animateBy}if(!sentence.function)sentence.function=false};var animateNodes=(sentence,parentElement)=>{parentElement.classList.add("word");let childs=Array.prototype.slice.call(parentElement.childNodes);let wordDelay=options.animDelay;childs.forEach(function(word,index){word.setAttribute("style",`animation: i-${sentence.iDirection} ${options.animDuration}ms ${wordDelay}ms cubic-bezier(0,.18,.12,.68) forwards`);wordDelay=options.animDelay+(sentence.timeToRead/childs.length-1)*(index+1)})};var create=()=>{if(!options.sentences){console.error("anitext: No defined sentences were found")}for(let i in options.sentences){let cSentence=options.sentences[i];if(!cSentence.text){console.warn(`anitext: skipped sentence: ${Number(i)+1} (text is undefined)`);continue}setDefaults(cSentence);let text=document.createElement("div");if(cSentence.animateBy==="sentence"){text.innerHTML=cSentence.text}else if(cSentence.animateBy==="words"){text.innerHTML=splitWords(cSentence.text)}else{text.innerHTML=splitChars(cSentence.text)}text.addEventListener("animationend",function(){destroySentence(event)},false);if(cSentence.function){text.addEventListener("animationstart",function(){initCustomFn(cSentence.function,this)},false)}cSentence.fDirection=fDirection(Number(i));options.readDelay=Number(cSentence.timeToRead)+options.animDuration+options.animDelay;if(options.sentences[Number(i)+1]){if(cSentence.animateBy==="sentence"){text.setAttribute("style",`animation: i-${cSentence.iDirection} ${options.animDuration}ms ${options.animDelay}ms cubic-bezier(0,.18,.12,.68) forwards, f-${cSentence.fDirection} ${options.animDuration}ms ${options.readDelay}ms cubic-bezier(.74,.24,1,.72) forwards`)}else{animateNodes(cSentence,text);text.setAttribute("style",`animation: f-${cSentence.fDirection} ${options.animDuration}ms ${options.readDelay}ms cubic-bezier(.74,.24,1,.72) forwards`)}}else{if(cSentence.animateBy==="sentence"){text.setAttribute("style",`animation: i-${cSentence.iDirection} ${options.animDuration}ms ${options.animDelay}ms cubic-bezier(0,.18,.12,.68) forwards`)}else{animateNodes(cSentence,text)}}let container=document.querySelector(options.selector);container.appendChild(text);options.animDelay=options.readDelay+options.animDuration}};anitext.destroy=(()=>{document.querySelector(options.selector).innerHTML=""});anitext.init=function(customOptions){options={...defaults,...customOptions};anitext.destroy();create()};return anitext});